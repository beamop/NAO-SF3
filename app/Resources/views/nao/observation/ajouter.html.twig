{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://unpkg.com/js-datepicker/datepicker.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
{% endblock %}

{% block content %}
    <script src="https://unpkg.com/js-datepicker"></script>
    {{ form_start(form) }}
        <h3 class="front-green">Ajouter une observation</h3>
        <div class="form-group" style="display: flex;flex-wrap: wrap;">
            <label for="adresse">Adresse</label>
            {{ form_widget(form.adresse, { 'attr': {'class': 'form-control'} }) }}
            {% for errorItem in form.adresse.vars.errors %}
                <span class="help-inline">{{ errorItem.message }}</span>
            {% endfor %}
        </div>

        <div class="form-group" style="display: flex;flex-wrap: wrap;">
            <label for="date">Date</label>
            {{ form_widget(form.date, { 'attr': {'class': 'form-control'} }) }}
            {% for errorItem in form.date.vars.errors %}
                <span class="help-inline">{{ errorItem.message }}</span>
            {% endfor %}
        </div>

        <div class="form-group" style="display: flex;flex-wrap: wrap;">
            <label for="espece">Espèce</label>
            {{ form_widget(form.espece, { 'attr': {'class': 'form-control'} }) }}
            {% for errorItem in form.espece.vars.errors %}
                <span class="help-inline">{{ errorItem.message }}</span>
            {% endfor %}
        </div>

        <div class="form-group" style="display: flex;flex-wrap: wrap;">
            <label for="individuals">Nombre d'individus observés</label>
            {{ form_widget(form.individuals, { 'attr': {'class': 'form-control'} }) }}
            {% for errorItem in form.individuals.vars.errors %}
                <span class="help-inline">{{ errorItem.message }}</span>
            {% endfor %}
        </div>

        <div class="form-group" style="display: flex;flex-wrap: wrap;">
            <label for="commentaire">Commentaire</label>
            {{ form_widget(form.commentaire, { 'attr': {'class': 'form-control'} }) }}
            {% for errorItem in form.commentaire.vars.errors %}
                <span class="help-inline">{{ errorItem.message }}</span>
            {% endfor %}
        </div>

        <hr>

        <div class="form-actions">
            <a class="btn btn-default" href="/observation">Retour à la carte</a>
            <button type="submit" id="observation_save" class="btn btn-primary">Ajouter l'observation</button>
        </div>
    {{ form_widget(form) }}
    {{ form_end(form) }}
{% endblock %}

{% block javascripts %}
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places&key=AIzaSyB9aZefiyGfTLfqolpIOMny-2Qa3ssDQFE"></script>

    <script>
        function initialize() {
            var input = document.getElementById('observation_adresse');
            new google.maps.places.Autocomplete(input);
        }

        google.maps.event.addDomListener(window, 'load', initialize);

        $(document).ready(function() {
            $("#observation_espece").autocomplete({
                source: function (request, response) {
                    $.post("{{ path('bird.search') }}", request, response);
                },
                minLength: 2,
                select: function (event, ui) {
                    $("#observation_espece").val($(this).val());
                }
            })
        });
    </script>
{% endblock %}